# 事务

### ACID 特性

* Atomicity 原子性
* Consistency 一致性
* Isolation 隔离性
* Durability 持久性

#### Atomicity 原子性

由A向转账50元（两次操作，不可分割）
* A(50)-50
* B(50)+50
* ----
* A:0
* B:100
  * 代表转账成功

#### Consistency 一致性

初始状态
* A:50
* B:50

设定限制条件
* A+B=100（初始情况下这个条件是被满足的）

如果执行了事务
* A-20
  * 30
* B+30
  * 80

(A+B)>100，虽然具备原子性，但不具备一致性

所以不能称为是一个正确的事务

#### Isolation 隔离性

高并发下，短时间内收到多个请求

为了提高性能，数据库管理系统往往需要交叉执行多个并发事务，而隔离性在这种情况下仍然要保证数据的一致性

#### Durability 持久性

必须将数据永久性的写入数据库

#### 跨文档 ACID 事务
* 4.0 单文档事务 -> 跨文档事务
  * 用户可以在同一个事务进行对多个文档的操作
* 4.2 复制集事务 -> 分片集群事务
