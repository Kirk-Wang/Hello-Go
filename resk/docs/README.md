# [3小时极简春节抢红包之Go的实战](https://www.imooc.com/learn/1101) 笔记📒

### 红包资金交易秒杀系统架构设计

* 需求分析方法和用例定义方法
* 四色建模法和核心模型设计
* 系统架构设计
* 数据库物理模型设计
* Golang编程实践
* 资金交易安全问题探讨
* 超卖问题的解决方案
* 表结构设计中的性能优化考虑
* 红包拆解和红包算法
* 系统设计和算法的选择

### 红包系统演进之路

* 满足红包业务需求，快速迭代上线
* 出现超卖现象，事务锁来帮忙
* 流量增加，收红包出现性能瓶颈，改为乐观锁，性能提高3倍
* 流量继续增加，乐观锁也扛不住了，那就上缓存吧
* 缓存还没跑溜，服务器挂了，数据丢失了？
* 分布式消息队列来解决异步写？
* 数据分片来解决数据库横向扩展？

### 课程能学到什么？

1. 红包业务系统的需求分析方法和用例定义方法
2. 学习四色建模法的基本知识，并结合红包业务场景把需求转化为业务模型来深入学习四色建模方法
3. 学习在四色建模法建模过程中如何绘制时间抽事件模型图？
4. 通过业务模型如何来拆分业务系统模块？然后通过业务模型来学习如何定义业务边界？
5. 从业务模型和架构目标和愿景来学习架构设计过程、设计方法？
6. 学习如何从业务模型推到物理模型？
7. 如何从数据库物理模型设计上和系统架构设计上来优化性能？
8. 如何解决资金交易安全（超卖）问题和资金交易上性能优化？并结合超卖方案来学习使用 Golang 编程语言来做基准测试
9. 如何在不同的场景和时机中设计和应用红包算法
10. 学习 Golang 项目如何构建？
11. 在 Golang 中如何设计和解决基础公共资源的访问问题？
12. 学习使用 Golang 接口来设计基础资源加载和启动的基础设施组件，学习对基础资源组件生命周期的管理的设计？

### 红包业务场景

* 场景概述
* 场景分析
* 用例分析和定义：发、收（抢、摇）红包

#### 场景概述

场景分类：祝福、庆祝、营销、显摆、曝光、求问等。

#### 场景分析

* 有发红包，就有收红包。
* 发红包
  * 普通红包
    * 固定的数量和每个红包的金额
  * 碰运气红包
    * 固定的数量和红包的总金额
* 收红包
  * `抢`和`摇`两种（后端本质上它们是一样的）
    * `摇` 红包可能要借助手机📱等相关设备来完成互动
    * `摇` 红包的流量是不确定的

简短描述下业务流程：

购买了`红包`产品，发布`红包`产品的过程。

红包发送者从红包中间商购买一定数量和一定金额的红包，然后赠送出去。赠送就是发布商品的过程，赠送的对象就是红包发送者选定的目标人或人群。

收红包就是商品的秒杀活动，抢`红包发送者`发送的红包，目标人群中有人会抢到红包。`红包受益人`将红包金融产品交给`红包中间商`兑换面值并转换为金额，然后存入个人钱包账户

#### 用例定义和分析方法概述

**用例定义的主要元素**

* 用例名称
  - 需求的名称
* 场景概述
  - 一句话需求，是谁？在哪里？什么时候？做了什么事情？产生了什么结果？
* 用例描述
  - 业务流程(1,2,3,4,5)
* 用例价值（可选，老板说的，客户要的，不会去分析相关价值）
  - 需求的价值。
* 约束和限制（可选）
  - 限制红包数量，金额
  - 法律的要求等……

红包业务分为 4 类业务场景：
  - 发红包
  - 收红包
    - 抢
    - 摇
  - 用户的资金账户

#### 发红包业务场景概述

场景概述

* 按红包类型：普通红包和碰运气红包
  * 普通红包：数量和单个金额固定
  * 碰运气红包：数量和总金额固定